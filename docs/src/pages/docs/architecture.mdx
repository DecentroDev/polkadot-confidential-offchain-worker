---
sidebarTitle: Architecture
title: "Architecture & Design"
description: "Detailed architecture of the Confidential API Off-Chain Worker."
---

import { Diagram } from "nextra-theme-docs";

# Architecture & Design

The **Confidential API Off-Chain Worker** is designed to securely fetch external data while ensuring **privacy, security, and efficient execution**.

---

## **üìå Overview of the Architecture**

The library consists of three main components:

1Ô∏è‚É£ **Off-Chain Worker Execution** ‚Äì Triggers the HTTP request from inside a Substrate pallet.  

2Ô∏è‚É£ **HTTP Request Handling** ‚Äì Uses the `HttpRequest` struct to securely fetch external data.  

3Ô∏è‚É£  **Response Processing & Storage** ‚Äì Parses the API response and optionally submits it back on-chain.  

4Ô∏è‚É£ **Subway Secure RPC Proxy** ‚Äì Enhances security and efficiency for JSON-RPC calls.  



## **üìå System Diagram**
```
+--------------------------+
|     Substrate Blockchain |
+-----------+--------------+
      |
      | 1Ô∏è‚É£ Block Finalized
      v
+--------------------------+
|     Off-Chain Worker     |
+-----------+--------------+
      |
      | 2Ô∏è‚É£ Read Events
      v
+--------------------------+
| Process Pending Events  |
+-----------+--------------+
      |
      | 3Ô∏è‚É£ Fetch External API
      v
+--------------------------+
| HTTP Client (Fetcher.rs) |
+-----------+--------------+
      |
      | 4Ô∏è‚É£ Validate & Parse
      v
+--------------------------+
|   Store Data / Submit TX  |
+--------------------------+

  ```

## **üìå Execution Flow**

1Ô∏è‚É£ An event or extrinsic triggers the off-chain worker.  

2Ô∏è‚É£ The worker makes an **HTTP GET request** using `HttpRequest`.  

3Ô∏è‚É£ The response is **validated and parsed** before use.  

4Ô∏è‚É£ The data is optionally **stored on-chain** or used for further processing.  

---

## üî• **Security Considerations**

- **Rate Limiting** ‚Äì Avoid excessive API requests to prevent bans.  
- **Response Validation** ‚Äì Always verify external data before using it on-chain.  
- **Confidentiality** ‚Äì Ensure sensitive API keys are not exposed in logs.  
- **Secure RPC Calls** ‚Äì Consider using [**Subway**](https://github.com/AcalaNetwork/subway) as a **secure proxy** for JSON-RPC requests to enhance security and efficiency.  

---

## üéØ **Next Steps**  

Now that you‚Äôve integrated **secure API key storage** and **off-chain worker execution**, explore the **architecture** to optimize your implementation.  

[**‚Üí Learn more about Subway for Secure RPC Calls**](https://github.com/AcalaNetwork/subway)  
[**‚Üí Read the Off-Chain Worker Docs**](/docs)  